type Event @entity {
  id: ID!
  version: Version!
  fund: Fund
  name: String!
  contract: String!
  hash: String!
  from: String!
  timestamp: BigInt!
  block: BigInt!
}

type Version @entity {
  id: ID!
  funds: [Fund!]! @derivedFrom(field: "version")
  events: [Event!]! @derivedFrom(field: "version")
  assets: [Asset!]!
}

type Fund @entity {
  id: ID!
  name: String!
  version: Version!
  active: Boolean!
  manager: Account!
  events: [Event!]! @derivedFrom(field: "fund")
  investments: [Investment!]! @derivedFrom(field: "fund")
}

interface InvestmentChange {
  id: ID!
  fund: Fund!
  investor: Account!
  investment: Investment!
}

type InvestmentAddition implements InvestmentChange @entity {
  id: ID!
  fund: Fund!
  investor: Account!
  investment: Investment!
  shares: BigInt!
  asset: Asset!
  amount: BigInt!
  requestTimestamp: BigInt!
  requestTransaction: String!
  executionTimestamp: BigInt
  executionTransaction: String
  cancallationTimestamp: BigInt
  cancellationTransaction: String
}

type InvestmentRedemption implements InvestmentChange @entity {
  id: ID!
  fund: Fund!
  investor: Account!
  investment: Investment!
  shares: BigInt!
  assets: [Asset!]!
  amounts: [BigInt!]!
  timestamp: BigInt!
  transaction: String!
}

type Investment @entity {
  id: ID!
  fund: Fund!
  investor: Account!
  changes: [InvestmentChange!]! @derivedFrom(field: "investment")
  shares: BigInt!
}

type Account @entity {
  id: ID!
  manager: Boolean!
  managements: [Fund!]! @derivedFrom(field: "manager")
  investor: Boolean!
  investments: [Investment!]! @derivedFrom(field: "investor")
}

type Asset @entity {
  id: ID!
  name: String!
  symbol: String!
  decimals: Int!
}
